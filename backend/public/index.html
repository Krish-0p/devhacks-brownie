<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scribble â€” Draw & Guess!</title>
  <meta name="description" content="Real-time multiplayer drawing and guessing game. Create a room, invite friends, and have fun!">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <!-- ========== AUTH: LOGIN VIEW ========== -->
  <div id="view-login" class="view">
    <div class="auth-container">
      <div class="landing-logo">
        <h1>ğŸ¨ Scribble</h1>
        <p class="tagline">Draw, Guess & Have Fun!</p>
      </div>
      <div class="auth-card glass-card">
        <h2 class="auth-title">Sign In</h2>
        <form id="login-form" class="auth-form">
          <div class="input-group">
            <label for="login-email">Email</label>
            <input type="email" id="login-email" placeholder="you@example.com" required autocomplete="email">
          </div>
          <div class="input-group">
            <label for="login-password">Password</label>
            <input type="password" id="login-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required autocomplete="current-password">
          </div>
          <span class="auth-error" id="login-error"></span>
          <button type="submit" class="btn btn-primary auth-btn" id="login-btn">Sign In</button>
        </form>
        <div class="auth-links">
          <a href="#" id="link-forgot">Forgot password?</a>
          <span class="auth-links-sep">â€¢</span>
          <a href="#" id="link-register">Create account</a>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== AUTH: MFA VERIFY VIEW ========== -->
  <div id="view-mfa-login" class="view">
    <div class="auth-container">
      <div class="landing-logo">
        <h1>ğŸ¨ Scribble</h1>
        <p class="tagline">Two-Factor Authentication</p>
      </div>
      <div class="auth-card glass-card">
        <h2 class="auth-title">ğŸ” Enter MFA Code</h2>
        <p class="auth-subtitle">Open your authenticator app and enter the 6-digit code.</p>
        <form id="mfa-login-form" class="auth-form">
          <div class="input-group">
            <label for="mfa-login-otp">Authenticator Code</label>
            <input type="text" id="mfa-login-otp" placeholder="000000" maxlength="6" autocomplete="one-time-code" inputmode="numeric" required>
          </div>
          <span class="auth-error" id="mfa-login-error"></span>
          <button type="submit" class="btn btn-primary auth-btn" id="mfa-login-btn">Verify</button>
        </form>
        <div class="auth-links">
          <a href="#" id="link-back-login">â† Back to Sign In</a>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== AUTH: REGISTER VIEW ========== -->
  <div id="view-register" class="view">
    <div class="auth-container">
      <div class="landing-logo">
        <h1>ğŸ¨ Scribble</h1>
        <p class="tagline">Draw, Guess & Have Fun!</p>
      </div>
      <div class="auth-card glass-card">
        <h2 class="auth-title">Create Account</h2>
        <form id="register-form" class="auth-form">
          <div class="input-group">
            <label for="register-email">Email</label>
            <input type="email" id="register-email" placeholder="you@example.com" required autocomplete="email">
          </div>
          <div class="input-group">
            <label for="register-username">Username</label>
            <div class="input-with-status">
              <input type="text" id="register-username" placeholder="cool_artist" required minlength="3" maxlength="20" autocomplete="username" pattern="[a-z0-9_]+">
              <span class="input-status" id="username-status"></span>
            </div>
            <span class="input-hint" id="username-hint">3-20 chars â€¢ lowercase letters, numbers, underscores</span>
          </div>
          <div class="input-group">
            <label for="register-password">Password</label>
            <input type="password" id="register-password" placeholder="Min 8 characters" required autocomplete="new-password" minlength="8">
          </div>
          <div class="input-group">
            <label for="register-confirm">Confirm Password</label>
            <input type="password" id="register-confirm" placeholder="Re-enter password" required autocomplete="new-password" minlength="8">
          </div>
          <span class="auth-error" id="register-error"></span>
          <button type="submit" class="btn btn-primary auth-btn" id="register-btn">Create Account</button>
        </form>
        <div class="auth-links">
          <a href="#" id="link-login-from-register">Already have an account? Sign In</a>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== AUTH: VERIFY EMAIL VIEW ========== -->
  <div id="view-verify-email" class="view">
    <div class="auth-container">
      <div class="landing-logo">
        <h1>ğŸ¨ Scribble</h1>
        <p class="tagline">Verify Your Email</p>
      </div>
      <div class="auth-card glass-card">
        <h2 class="auth-title">ğŸ“§ Check Your Inbox</h2>
        <p class="auth-subtitle">We sent a 6-digit code to <strong id="verify-email-address"></strong></p>
        <form id="verify-email-form" class="auth-form">
          <div class="input-group">
            <label for="verify-otp">Verification Code</label>
            <input type="text" id="verify-otp" placeholder="000000" maxlength="6" autocomplete="one-time-code" inputmode="numeric" required>
          </div>
          <span class="auth-error" id="verify-email-error"></span>
          <button type="submit" class="btn btn-primary auth-btn" id="verify-email-btn">Verify Email</button>
        </form>
        <div class="auth-links">
          <a href="#" id="link-resend-otp">Resend code</a>
          <span class="auth-links-sep">â€¢</span>
          <a href="#" id="link-login-from-verify">Back to Sign In</a>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== AUTH: FORGOT PASSWORD VIEW ========== -->
  <div id="view-forgot-password" class="view">
    <div class="auth-container">
      <div class="landing-logo">
        <h1>ğŸ¨ Scribble</h1>
        <p class="tagline">Reset Password</p>
      </div>
      <div class="auth-card glass-card">
        <h2 class="auth-title">ğŸ”‘ Forgot Password</h2>
        <!-- Step 1: Request OTP -->
        <div id="forgot-step-1">
          <p class="auth-subtitle">Enter your email and we'll send a reset code.</p>
          <form id="forgot-email-form" class="auth-form">
            <div class="input-group">
              <label for="forgot-email">Email</label>
              <input type="email" id="forgot-email" placeholder="you@example.com" required autocomplete="email">
            </div>
            <span class="auth-error" id="forgot-error"></span>
            <button type="submit" class="btn btn-primary auth-btn" id="forgot-send-btn">Send Reset Code</button>
          </form>
        </div>
        <!-- Step 2: Enter OTP + New Password -->
        <div id="forgot-step-2" style="display:none;">
          <p class="auth-subtitle">Enter the code sent to <strong id="forgot-email-display"></strong></p>
          <form id="forgot-reset-form" class="auth-form">
            <div class="input-group">
              <label for="forgot-otp">Reset Code</label>
              <input type="text" id="forgot-otp" placeholder="000000" maxlength="6" autocomplete="one-time-code" inputmode="numeric" required>
            </div>
            <div class="input-group">
              <label for="forgot-new-password">New Password</label>
              <input type="password" id="forgot-new-password" placeholder="Min 8 characters" required minlength="8">
            </div>
            <span class="auth-error" id="forgot-reset-error"></span>
            <button type="submit" class="btn btn-primary auth-btn" id="forgot-reset-btn">Reset Password</button>
          </form>
        </div>
        <div class="auth-links">
          <a href="#" id="link-login-from-forgot">â† Back to Sign In</a>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== PROFILE VIEW ========== -->
  <div id="view-profile" class="view">
    <div class="profile-page">
      <!-- Header -->
      <div class="profile-header">
        <a href="#" id="link-back-from-profile" class="profile-back-link">â† Back to Game</a>
        <div class="profile-header-title">
          <h1>ğŸ¨ Scribble</h1>
          <span class="profile-header-sep">â€”</span>
          <span class="profile-header-subtitle">Your Profile</span>
        </div>
        <div class="profile-header-spacer"></div>
      </div>

      <!-- Two-column body -->
      <div class="profile-body">
        <!-- Left: Avatar + Stats -->
        <div class="profile-left glass-card">
          <div class="profile-avatar-section">
            <div class="profile-avatar" id="profile-avatar">
              <span id="profile-avatar-initial">?</span>
            </div>
            <div class="profile-avatar-actions">
              <label for="avatar-file-input" class="btn btn-outline btn-small" id="avatar-upload-label">ğŸ“· Upload Photo</label>
              <input type="file" id="avatar-file-input" accept="image/*" hidden>
              <button class="btn btn-danger btn-small" id="btn-remove-avatar" style="display:none;">ğŸ—‘ï¸ Remove</button>
            </div>
            <span class="auth-error" id="avatar-error"></span>
          </div>

          <div class="profile-stats-section">
            <h3 class="profile-section-title">ğŸ“Š Game Stats</h3>
            <div class="profile-stats-grid" id="profile-stats-grid"></div>
          </div>
        </div>

        <!-- Center: Form -->
        <div class="profile-center glass-card">
          <h2 class="profile-form-title">Account Details</h2>
          <form id="profile-form" class="profile-form">
            <div class="profile-fields-grid">
              <div class="input-group">
                <label for="profile-email">Email</label>
                <input type="email" id="profile-email" disabled class="input-disabled">
              </div>
              <div class="input-group">
                <label for="profile-username">Username</label>
                <div class="input-with-status">
                  <input type="text" id="profile-username" placeholder="your_username" minlength="3" maxlength="20" pattern="[a-z0-9_]+" autocomplete="username">
                  <span class="input-status" id="profile-username-status"></span>
                </div>
                <span class="input-hint" id="profile-username-hint">3-20 chars â€¢ lowercase letters, numbers, underscores</span>
              </div>
              <div class="input-group">
                <label for="profile-first-name">First Name</label>
                <input type="text" id="profile-first-name" placeholder="First name" maxlength="50" autocomplete="given-name">
              </div>
              <div class="input-group">
                <label for="profile-last-name">Last Name</label>
                <input type="text" id="profile-last-name" placeholder="Last name" maxlength="50" autocomplete="family-name">
              </div>
            </div>
            <span class="auth-error" id="profile-error"></span>
            <button type="submit" class="btn btn-primary profile-save-btn" id="profile-save-btn">Save Changes</button>
          </form>
        </div>

        <!-- Right: Security / MFA -->
        <div class="profile-right glass-card">
          <h2 class="profile-form-title">ğŸ” Security</h2>
          <div id="mfa-setup-card" class="mfa-panel">
            <!-- dynamically populated by profile.js -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== LANDING VIEW (authenticated) ========== -->
  <div id="view-landing" class="view">
    <div class="landing-container">
      <div class="landing-logo">
        <h1>ğŸ¨ Scribble</h1>
        <p class="tagline">Draw, Guess & Have Fun!</p>
      </div>
      <div class="landing-card glass-card">
        <div class="landing-user-info" id="landing-user-info">
          <div class="user-greeting">
            <span id="user-avatar-display" class="user-avatar-small"></span>
            <span>Hello, <strong id="user-display-name"></strong>!</span>
          </div>
          <div class="user-stats" id="user-stats"></div>
        </div>
        <div class="landing-actions">
          <button id="btn-create-room" class="btn btn-primary">
            <span class="btn-icon">âœ¨</span> Create Room
          </button>
          <div class="divider"><span>or</span></div>
          <div class="join-row">
            <input type="text" id="room-code-input" placeholder="Room Code" maxlength="6" autocomplete="off" spellcheck="false" class="room-code-field">
            <button id="btn-join-room" class="btn btn-secondary">
              Join
            </button>
          </div>
        </div>
        <div class="landing-bottom-actions">
          <button id="btn-profile" class="btn btn-outline btn-small">ğŸ‘¤ Profile</button>
          <button id="btn-logout" class="btn btn-danger btn-small">Logout</button>
        </div>
      </div>
      <div class="connection-status" id="connection-status">
        <span class="status-dot"></span>
        <span class="status-text">Connecting...</span>
      </div>
    </div>
  </div>

  <!-- ========== LOBBY VIEW ========== -->
  <div id="view-lobby" class="view">
    <div class="lobby-container">
      <div class="lobby-header">
        <h2>ğŸ  Room Lobby</h2>
        <div class="room-code-display">
          <span>Room Code:</span>
          <span class="code" id="lobby-room-code">------</span>
          <button class="btn-icon-only" id="btn-copy-code" title="Copy code">ğŸ“‹</button>
        </div>
      </div>
      <div class="lobby-card glass-card">
        <h3>Players <span id="player-count" class="badge">0</span></h3>
        <ul id="lobby-player-list" class="player-list"></ul>
        <div class="lobby-actions">
          <button id="btn-start-game" class="btn btn-primary" style="display:none;">
            <span class="btn-icon">ğŸ®</span> Start Game
          </button>
          <p id="lobby-waiting-text" class="muted-text">Waiting for host to start...</p>
          <button id="btn-leave-room" class="btn btn-danger">
            Leave Room
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== GAME VIEW ========== -->
  <div id="view-game" class="view">
    <div class="game-layout">
      <!-- Top Bar -->
      <div class="game-top-bar">
        <div class="round-info">
          <span id="game-round">Round 1</span>
          <span class="dot-sep">â€¢</span>
          <span id="game-turn">Turn 1</span>
        </div>
        <div class="word-display" id="word-display">
          <span id="word-text">Waiting...</span>
        </div>
        <div class="timer-area">
          <span id="timer-text" class="timer-text">60</span>
          <div class="timer-bar-container">
            <div class="timer-bar" id="timer-bar"></div>
          </div>
        </div>
      </div>

      <!-- Main Area -->
      <div class="game-main">
        <!-- Player Sidebar -->
        <div class="player-sidebar glass-card">
          <h4>Players</h4>
          <ul id="game-player-list" class="player-list compact"></ul>
        </div>

        <!-- Canvas Area -->
        <div class="canvas-area">
          <canvas id="drawing-canvas" width="800" height="540"></canvas>
          <!-- Drawing Tools -->
          <div class="drawing-tools" id="drawing-tools" style="display:none;">
            <div class="color-palette" id="color-palette">
              <div class="color-swatch active" data-color="#000000" style="background:#000000"></div>
              <div class="color-swatch" data-color="#FFFFFF" style="background:#FFFFFF; border:1px solid #555"></div>
              <div class="color-swatch" data-color="#EF4444" style="background:#EF4444"></div>
              <div class="color-swatch" data-color="#F97316" style="background:#F97316"></div>
              <div class="color-swatch" data-color="#EAB308" style="background:#EAB308"></div>
              <div class="color-swatch" data-color="#22C55E" style="background:#22C55E"></div>
              <div class="color-swatch" data-color="#06B6D4" style="background:#06B6D4"></div>
              <div class="color-swatch" data-color="#3B82F6" style="background:#3B82F6"></div>
              <div class="color-swatch" data-color="#8B5CF6" style="background:#8B5CF6"></div>
              <div class="color-swatch" data-color="#EC4899" style="background:#EC4899"></div>
              <div class="color-swatch" data-color="#78716C" style="background:#78716C"></div>
              <div class="color-swatch" data-color="#92400E" style="background:#92400E"></div>
            </div>
            <div class="stroke-controls">
              <button class="stroke-btn" data-width="3" title="Thin">
                <span class="stroke-preview" style="width:6px;height:6px"></span>
              </button>
              <button class="stroke-btn active" data-width="6" title="Medium">
                <span class="stroke-preview" style="width:10px;height:10px"></span>
              </button>
              <button class="stroke-btn" data-width="12" title="Thick">
                <span class="stroke-preview" style="width:16px;height:16px"></span>
              </button>
            </div>
            <button class="btn btn-small btn-outline" id="btn-clear-canvas">ğŸ—‘ï¸ Clear</button>
          </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area glass-card">
          <div class="chat-messages" id="chat-messages"></div>
          <div class="chat-input-area">
            <input type="text" id="chat-input" placeholder="Type your guess..." autocomplete="off" spellcheck="false">
            <button id="btn-send-chat" class="btn btn-primary btn-small">Send</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== MODALS ========== -->
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal-content glass-card" id="modal-content">
      <!-- Dynamically populated -->
    </div>
  </div>

  <!-- ========== TOAST ========== -->
  <div id="toast-container" class="toast-container"></div>

  <!-- Scripts -->
  <script src="/js/ui.js"></script>
  <script src="/js/api.js"></script>
  <script src="/js/socket.js"></script>
  <script src="/js/canvas.js"></script>
  <script src="/js/chat.js"></script>
  <script src="/js/game.js"></script>
  <script src="/js/pages/login.js"></script>
  <script src="/js/pages/mfa-login.js"></script>
  <script src="/js/pages/register.js"></script>
  <script src="/js/pages/verify-email.js"></script>
  <script src="/js/pages/forgot-password.js"></script>
  <script src="/js/pages/profile.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>
